{% extends "base.html" %}

{% block title %}–°–µ—Ä–≤–µ—Ä—ã - MomsVPN Admin{% endblock %}
{% block page_title %}üñ•Ô∏è –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–æ–≤{% endblock %}

{% block content %}
<div class="servers-grid">
    <div class="server-card {% if server.online %}status-online{% else %}status-offline{% endif %}">
        <div class="server-header">
            <span class="server-icon">üá≥üá±</span>
            <span class="server-name">–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã</span>
            <span class="server-status-dot {% if server.online %}online{% else %}offline{% endif %}"></span>
        </div>

        <div class="server-info">
            {% if server.online %}
            <div class="info-row">
                <span>–°—Ç–∞—Ç—É—Å:</span>
                <span class="value online">üü¢ Online</span>
            </div>
            <div class="info-row">
                <span>–í–µ—Ä—Å–∏—è:</span>
                <span class="value">{{ server.version or 'N/A' }}</span>
            </div>
            <div class="info-row">
                <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–Ω–ª–∞–π–Ω:</span>
                <span class="value">{{ server.online_users or 0 }}</span>
            </div>
            <div class="info-row">
                <span>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</span>
                <span class="value">{{ server.total_users or 0 }}</span>
            </div>
            <div class="info-row">
                <span>CPU:</span>
                <span class="value">{{ server.cpu_usage or 0 }}%</span>
            </div>
            <div class="info-row">
                <span>–ü–∞–º—è—Ç—å:</span>
                {% if server.mem_total %}
                {% set mem_percent = (server.mem_used / server.mem_total * 100)|round(1) %}
                <span class="value">{{ mem_percent }}%</span>
                {% else %}
                <span class="value">N/A</span>
                {% endif %}
            </div>
            {% else %}
            <div class="info-row error">
                <span>–°—Ç–∞—Ç—É—Å:</span>
                <span class="value offline">üî¥ Offline</span>
            </div>
            <p class="error-message">–°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.</p>
            {% endif %}
        </div>

        <div class="server-actions">
            <button class="btn btn-primary" onclick="refreshServerStatus()">
                üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function refreshServerStatus() {
        location.reload();
    }

    // Auto-refresh every 30 seconds
    setInterval(function () {
        fetch('/admin/api/servers/status')
            .then(r => r.json())
            .then(data => {
                // Update status indicator
                const dot = document.querySelector('.server-status-dot');
                if (data.online) {
                    dot.classList.add('online');
                    dot.classList.remove('offline');
                } else {
                    dot.classList.add('offline');
                    dot.classList.remove('online');
                }
            });
    }, 30000);
</script>
{% endblock %}